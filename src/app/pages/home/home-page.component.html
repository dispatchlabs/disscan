<div class="home-page">
    <div *ngIf="loading" class="loading-overlay">
        <div class="loading">
            <div class="ping"></div>
            <div class="ping one"></div>
            <div class="ping two"></div>
            <div class="icon">
                <img src="assets/images/icon-character-black.png">
            </div>
        </div>
    </div>

    <div *ngIf="refreshOverlay" class="loading-overlay">
        <div class="loading">
            <div class="ping"></div>
            <div class="ping one"></div>
            <div class="ping two"></div>
            <div class="icon">
                <img src="assets/images/icon-character-black.png">
            </div>
        </div>
    </div>

    <div class="container" *ngIf="!loading">
        <div fxLayout="column" fxLayout.gt-sm="row" ngClass.gt-sm="two-column-container" class="bg-dark p20">
            <div fxFlex.gt-sm="25" class="fade-in-up">
                <div class="list-header" fxLayout="column">
                    <div fxFlex>
                        <h3><i class="far fa-cubes fa-fw"></i> Delegates</h3>
                    </div>
                    <div fxFlex class="refresh">
                        <a (click)="refresh()"><i class="far fa-sync fa-fw"></i> Refresh</a>
                    </div>
                </div>
                <div class="list-body">
                    <div fxLayout="row" *ngFor="let delegate of config?.delegates" class="list-item" (click)="select(delegate)">
                        <div fxFlex>
                            <ul class="none">
                                <!--li>{{delegate.address}}</li-->
                                <li>{{delegate.endpoint.host}}</li>
                                <li>{{delegate.endpoint.port}}</li>
                            </ul>
                        </div>
                        <div *ngIf="config.selectedDelegate?.address === delegate.address">
                            <i class="fa fa-check-circle"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div fxFlex.gt-sm="75" class="fade-in-up delay-1">
                <div class="list-header" fxLayout="column">
                    <div fxFlex>
                        <h3><i class="fal fa-list-ul fa-fw"></i> Transactions</h3>
                    </div>
                    <div fxFlex>
                        <i class="fal fa-cube fa-fw"></i> <span *ngIf="config.selectedDelegate">{{config.selectedDelegate.address}}</span>
                    </div>
                </div>
                <div class="list-body">
                    <div *ngIf="config.selectedDelegate; else noActiveDelegateTemplate">
                        <div class="search">
                            <div fxLayout="row">
                                <div fxFlex class="relative">
                                    <mat-form-field >
                                        <input [(ngModel)]="search" matInput placeholder="Enter 'From' Address">
                                    </mat-form-field>
                                </div>
                                <div class="search-button">
                                    <button mat-icon-button [disabled]="search?.length < 40" (click)=" getTransactions()"><mat-icon>search</mat-icon></button>
                                </div>
                            </div>
                        </div>
                        <mat-table #table [dataSource]="dataSource">

                            <!-- To -->
                            <ng-container cdkColumnDef="to">
                                <mat-header-cell *cdkHeaderCellDef> To</mat-header-cell>
                                <mat-cell *cdkCellDef="let row"> {{row.to}}</mat-cell>
                            </ng-container>

                            <!-- Value -->
                            <ng-container cdkColumnDef="value">
                                <mat-header-cell *cdkHeaderCellDef class="center"> Value</mat-header-cell>
                                <mat-cell *cdkCellDef="let row" class="center"> {{row.value}}</mat-cell>
                            </ng-container>

                            <!-- Time -->
                            <ng-container cdkColumnDef="time">
                                <mat-header-cell *cdkHeaderCellDef class="center"> Time</mat-header-cell>
                                <mat-cell *cdkCellDef="let row" class="center"> {{row.time | m2SimpleDateTime}}</mat-cell>
                            </ng-container>

                            <!-- Type -->
                            <ng-container cdkColumnDef="type">
                                <mat-header-cell *cdkHeaderCellDef class="right"> Type</mat-header-cell>
                                <mat-cell *cdkCellDef="let row" class="right">
                                    {{row.typeLabel}}
                                </mat-cell>
                            </ng-container>

                            <mat-header-row *cdkHeaderRowDef="displayedColumns"></mat-header-row>
                            <mat-row *cdkRowDef="let row; columns: displayedColumns;" (click)="appService.openTransaction(row)"></mat-row>
                        </mat-table>
                    </div>
                    <ng-template #noActiveDelegateTemplate>
                        <div class="p20">
                            <div fxLayout="row" fxLayoutAlign="center center">
                                <div class="bounce-left">
                                    <i class="fas fa-chevron-left"></i>
                                </div>
                                <div fxFlex>
                                    <h3>Choose a delegate from the list to see it's transactions</h3>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </div>
            </div>
        </div>
    </div>
</div>